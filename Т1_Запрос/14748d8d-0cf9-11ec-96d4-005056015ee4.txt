{
 'Реквизиты': {
  'Наименование': 'Количество дублей контрагентов',
  'ТекстОбработки': 'Дублей = 0;

	Запрос = Новый Запрос;
	Запрос.Текст = ПолучитьЗначениеПеременной(Переменные,"ТекстЗапросаДетально"); //ТекстЗапросаДетально
	РезультатЗапроса = Запрос.Выполнить();
	Выборка = РезультатЗапроса.Выбрать();
	Пока Выборка.Следующий() Цикл
		Дублей = Выборка.Дублей;
		Если Выборка.Количество() < 100 Тогда
			Сообщить(Дублей);
		КонецЕсли;	
	КонецЦикла; 
	
	


СтрокаОшибок = "Дублей - "+Дублей;',
  'Комментарий': ''
 },
 'ТЧ': [
  {
   'Переменные': [
    {
     'Имя': 'ТекстЗапроса',
     'Разделитель': null,
     'ЗначениеСтрока': 'ВЫБРАТЬ
    КОЛИЧЕСТВО(п.ИННКПП) КАК Дублей
ИЗ
    (ВЫБРАТЬ
        КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Контрагенты.Ссылка) КАК Ссылка,
        Контрагенты.ИНН + Контрагенты.КПП КАК ИННКПП
    ИЗ
        Справочник.Контрагенты КАК Контрагенты
    
    СГРУППИРОВАТЬ ПО
        Контрагенты.ИНН + Контрагенты.КПП
    
    ИМЕЮЩИЕ
        КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Контрагенты.Ссылка) > 1) КАК п',
     'Комментарий': ''
    },
    {
     'Имя': 'ТекстЗапросаДетально',
     'Разделитель': null,
     'ЗначениеСтрока': 'ВЫБРАТЬ
    п.ИННКПП КАК Дублей
ИЗ
    (ВЫБРАТЬ
        КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Контрагенты.Ссылка) КАК Ссылка,
        Контрагенты.ИНН + Контрагенты.КПП КАК ИННКПП
    ИЗ
        Справочник.Контрагенты КАК Контрагенты
    
    СГРУППИРОВАТЬ ПО
        Контрагенты.ИНН + Контрагенты.КПП
    
    ИМЕЮЩИЕ
        КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Контрагенты.Ссылка) > 1) КАК п',
     'Комментарий': ''
    }
   ]
  }
 ]
}
